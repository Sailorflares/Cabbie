
    
        
<!-- ******BLOG LIST****** --> 
<div class="blog blog-category blog-archive container">
    <h2 class="page-title text-center"><i class="fa fa-archive"></i> <%= @driver.formatted_name %> </h2>
      <div class="row">
        <div class="col-md-2">
        </div>
        <div class="col-md-4">
          <% if @driver.medallion_number.length == 4 %>
              <h4>Medallion Number: <%= @driver.medallion_number %></h4><br>
            <% else %>
              <h4>License Number: <%= @driver.medallion_number %></h4><br>
            <% end %>
            
        </div>
        <div class="col-md-4">
          <% if @driver.violations.size > 0 %>
              <h4>Number of Current Summonses: <%= @driver.violations.count %></h4><br>
              <% @driver.violations.each do |viol| %>
                  <h5>Date: <%= viol.date %></h5>
                  <h5>Charge: <%= viol.charge %></h5> 
                  <h5>Description: <%= viol.description %></h5> 
            <% end %>
          <% end %>
        </div>
        <div class="col-md-2">
        </div>
      </div>
    
  <% if @driver.ride_reviews.size == 0 %>
   
    <div class="row">
      <div class="col-md-7">
        <div class="blog-list blog-category-list">  
              <article class="post col-md-10 col-sm-12 col-xs-12 col-md-offset-1 col-sm-offset-0 col-xs-offset-0">
                  <div class="post-inner">
                      <div class="content"> 
                        
                          <h3 class="post-title text-center">It looks like <%= @driver.formatted_name %> doesn't have any reviews yet.</h3>     
                          <br>                
                          <h3 class="post-title text-center">Good news: you get to be the first one to review this driver!</h3>
                      </div><!--//content-->
                  </div><!--//post-inner-->
              </article><!--//post-->          
          </div><!--//blog-list-->    
    </div><!--//row-->

  <% else %>
    
    <div class="row">
          <% @driver.ride_reviews.reverse.each do |rev| %>    
      <div class="col-md-7">
        <div class="blog-list blog-category-list">
            <article class="post col-md-10 col-sm-12 col-xs-12 col-md-offset-1 col-sm-offset-0 col-xs-offset-0">
                <div class="post-inner">
                    <div class="content">
                        <div class="date-label">
                            <span class="month"><%= rev.created_at.localtime.strftime("%b") %></span>
                            <span class="date-number"><%= rev.created_at.localtime.strftime("%d") %></span>
                        </div>
                        <div class="row">
                          <div class="col-md-2">
                            <div class="star-ratings-css">
                              <div class="star-ratings-css-top" style="width: <%= rev.star_rating_percentage %>%"><span>★</span><span>★</span><span>★</span><span>★</span><span>★</span></div>
                              <div class="star-ratings-css-bottom"><span>★</span><span>★</span><span>★</span><span>★</span><span>★</span></div>
                            </div>
                          </div>  
                        </div>  
                   
                        <div class="meta">
                            <ul class="meta-list list-inline">                                       
                              <li class="post-author"><a href="<%= user_path(rev.user_id) %>"><%= rev.user.name %></a></li>
                              <li class="post-comments-link">
                                  <i class="fa fa-comments"></i>
                                    <!-- <div class="star-ratings-css">
                                      <div class="col-md-12"></div>
                                    </div> -->
                              </li>
                          </ul><!--//meta-list-->                             
                        </div><!--meta-->                               
                        <div class="post-entry">
                            <p><%= rev.comments %></p>
                            <!-- <a class="read-more" href="blog-single.html">Read more <i class="fa fa-long-arrow-right"></i></a> -->
                        </div>                                
                    </div><!--//content-->
                </div><!--//post-inner-->
            </article><!--//post-->
          </div>
          </div>  
            <% end %>
  <% end %>       
  </div>                       
        </div>

        <!-- <div class="col-md-5"> -->

          <% if current_user %>
      <div class="col-md-3" style="margin: 20px;">
        <h3>Write a Review for <%= @driver.formatted_name %>:</h3><br> 
        <%= form_for @ride_review, url: user_ride_reviews_path(@user) do |f| %>
          <h4>Rating:</h4>
          <p><%= f.select :star_rating, options_for_select([1,2,3,4,5]), :autofocus => false%></p>

        
          <p><%= f.text_area(:comments, :placeholder => "Review your driver", :class => "form-control", :rows => 10)%></p>
               <%= f.hidden_field :driver_id, :value => @driver.id %>
          <%= f.submit 'Submit review!', :class => 'btn btn-primary' %>
        <% end %>
    <% else %>
      <div class="col-md-4" style="margin: 50px;">
        <a href="/login" button type="button" class="btn btn-primary btn-lg btn-block">Please log in to write a review</a></button>
      </div>
    <% end %>    

        </div>  
      </div><!--//blog-list-->  
    </div><!--//row-->
</div><!--//blog-->        


<!-- ---------------------------------------------------------------------------------------- -->

<div class="container">
  <div class="row">
    
    <div class="col-md-6" style="margin:20px;">
      <h1><%= @driver.formatted_name %></h1>
      


    </div>

    <div class="col-md-5" style="margin:20px;">
      <h3>Average Rating:</h3>
      <div class="star-ratings-css">
        <div class="star-ratings-css-top" style="width: <%= @driver.star_percentage %>%"><span>★</span><span>★</span><span>★</span><span>★</span><span>★</span></div>
        <div class="star-ratings-css-bottom"><span>★</span><span>★</span><span>★</span><span>★</span><span>★</span></div>
    </div>
      <h3>Number of Reviews: <%= @driver.ride_reviews.size %></h3>
    </div>
  
  </div>
</div>


<div class="container">
  <div class="row">
    <div class="col-md-6" style="margin:20px;">
      <div class="well" style="height: 450px; width: 550px; overflow: auto;">
      <h2 style="text-align: center;">Reviews for <%= @driver.formatted_name %>:</h2><br>
        <% if @driver.ride_reviews.size == 0 %>
          <div class="row">
            <div class="col-md-10" style="display: inline-block; padding: 10px;">
              <div class="panel panel-primary">
                <div class="panel-body">
                  <h4>It looks like there are no reviews for <%= @driver.formatted_name %>.</h4><br>
                  <h4>Good news: you get to be the first one to review this driver!</h4>
                </div>
              </div>
            </div>
          </div>
        <% else %>
          <% @driver.ride_reviews.reverse.each do |rev| %>
            <div class="row">
              <div class="col-md-10" style="display: inline-block;">
                <div class="panel panel-primary">
                  <div class="panel-heading">
                    <h3 class="panel-title"><%= rev.created_at.localtime.strftime("%m/%d/%Y") %></h3>
                    <div class="star-ratings-css">
                      <div class="star-ratings-css-top" style="width: <%= rev.star_rating_percentage %>%"><span>★</span><span>★</span><span>★</span><span>★</span><span>★</span></div>
                      <div class="star-ratings-css-bottom"><span>★</span><span>★</span><span>★</span><span>★</span><span>★</span></div>
                    </div>
                  </div>
                  <div class="panel-body">
                    <a href="<%= user_path(rev.user_id) %>"><%= rev.user.name %></a><br>
                    <span class="glyphicon glyphicon-pencil"><p><%= pluralize(rev.user.ride_reviews.count, 'review') %></p></span>
                    <br>
                    <p><%= rev.comments %></p>
                    <div class="voting-system">
                      <% if current_user %>  
                        <%= form_for @vote, url: user_ride_review_votes_path(@user.id, rev.id) do |f| %>
                          <%= f.hidden_field :value_of_votes, :value => "1" %>
                          <%= f.hidden_field :ride_review_id, :value => rev.id %>
                          <%= f.button "", :class => "glyphicon glyphicon-thumbs-up" %>
                        <% end %>
                          <% if rev.votes  %>
                            <h5><%= rev.votes.map { |vote| vote.value_of_votes }.inject(:+) %></h5>
                          <% end %>
                        <%= form_for @vote, url: user_ride_review_votes_path(@user.id, rev.id) do |f| %>
                          <%= f.hidden_field :value_of_votes, :value => "-1" %>
                          <%= f.hidden_field :ride_review_id, :value => rev.id %>
                          <%= f.button "", :class => "glyphicon glyphicon-thumbs-down" %>
                        <% end %>
                      <% end %>  
                    </div>
                  </div>
                </div>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>
    <% if current_user %>
      <div class="col-md-5" style="margin: 20px;">
        <h3>Write a Review for <%= @driver.formatted_name %>:</h3><br> 
        <%= form_for @ride_review, url: user_ride_reviews_path(@user) do |f| %>
          <p><%= f.number_field :star_rating, :placeholder => "Rate your driver", :autofocus => false%></p>
        
          <p><%= f.text_area(:comments, :placeholder => "Review your driver", :class => "form-control", :rows => 10)%></p>
               <%= f.hidden_field :driver_id, :value => @driver.id %>
          <%= f.submit 'Submit review!', :class => 'btn btn-primary' %>
        <% end %>
    <% else %>
      <div class="col-md-4" style="margin: 50px;">
        <a href="/login" button type="button" class="btn btn-primary btn-lg btn-block">Please log in to write a review</a></button>
      </div>
    <% end %>    
    </div>
  </div>
</div>